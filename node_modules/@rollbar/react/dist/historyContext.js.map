{"version":3,"file":"historyContext.js","sources":["../src/history-context.js"],"sourcesContent":["import Rollbar from 'rollbar';\nimport invariant from 'tiny-invariant';\n\nexport function historyContext(rollbar, { formatter, filter } = {}) {\n  invariant(rollbar instanceof Rollbar, 'historyContext must have an instance of Rollbar');\n  invariant(formatter == null || typeof formatter === 'function', `formatter option must be a function, received ${typeof formatter} instead`);\n  invariant(filter == null || typeof filter === 'function', `filter option must be a function, received ${typeof filter} instead`);\n  // v4 of history.listen callback signature is (location, action)\n  // v5 of history.listen callback signature is ({ location, action })\n  // this implementation translates it to work for both\n  return (v4location, v4action) => {\n    let  { action, location } = v4location;\n    if (v4action) {\n      action = v4action;\n      location = v4location;\n    }\n    if (filter && !filter(location, action)) {\n      return;\n    }\n    const context = formatter ? formatter(location, action) : location.pathname;\n    invariant(typeof context === 'string', 'formatter must return a string value to set the context');\n    rollbar.configure({ payload: { context }});\n  }\n}\n"],"names":["historyContext","rollbar","formatter","filter","invariant","Rollbar","v4location","v4action","action","location","context","pathname","configure","payload"],"mappings":";;;;AAGO,SAASA,cAAT,CAAwBC,OAAxB,EAA6D;AAAA,iFAAJ,EAAI;AAAA,MAA1BC,SAA0B,QAA1BA,SAA0B;AAAA,MAAfC,MAAe,QAAfA,MAAe;;AAClEC,EAAAA,SAAS,CAACH,OAAO,YAAYI,OAApB,EAA6B,iDAA7B,CAAT;AACAD,EAAAA,SAAS,CAACF,SAAS,IAAI,IAAb,IAAqB,OAAOA,SAAP,KAAqB,UAA3C,kEAA+GA,SAA/G,eAAT;AACAE,EAAAA,SAAS,CAACD,MAAM,IAAI,IAAV,IAAkB,OAAOA,MAAP,KAAkB,UAArC,+DAAsGA,MAAtG,eAAT,CAHkE;AAKlE;AACA;;AACA,SAAO,UAACG,UAAD,EAAaC,QAAb,EAA0B;AAC/B,QAAOC,MAAP,GAA4BF,UAA5B,CAAOE,MAAP;AAAA,QAAeC,QAAf,GAA4BH,UAA5B,CAAeG,QAAf;;AACA,QAAIF,QAAJ,EAAc;AACZC,MAAAA,MAAM,GAAGD,QAAT;AACAE,MAAAA,QAAQ,GAAGH,UAAX;AACD;;AACD,QAAIH,MAAM,IAAI,CAACA,MAAM,CAACM,QAAD,EAAWD,MAAX,CAArB,EAAyC;AACvC;AACD;;AACD,QAAME,OAAO,GAAGR,SAAS,GAAGA,SAAS,CAACO,QAAD,EAAWD,MAAX,CAAZ,GAAiCC,QAAQ,CAACE,QAAnE;AACAP,IAAAA,SAAS,CAAC,OAAOM,OAAP,KAAmB,QAApB,EAA8B,yDAA9B,CAAT;AACAT,IAAAA,OAAO,CAACW,SAAR,CAAkB;AAAEC,MAAAA,OAAO,EAAE;AAAEH,QAAAA,OAAO,EAAPA;AAAF;AAAX,KAAlB;AACD,GAZD;AAaD;;;;"}