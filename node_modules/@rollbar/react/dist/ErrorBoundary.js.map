{"version":3,"file":"ErrorBoundary.js","sources":["../src/error-boundary.js"],"sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport invariant from 'tiny-invariant';\nimport { LEVEL_ERROR } from './constants';\nimport { Context, getRollbarFromContext } from './provider';\nimport * as utils from './utils';\n\nconst INITIAL_ERROR_STATE = { hasError: false, error: null };\n\nexport class ErrorBoundary extends Component {\n  static contextType = Context;\n\n  static propTypes = {\n    fallbackUI: PropTypes.elementType,\n    errorMessage: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    extra: PropTypes.oneOfType([PropTypes.object, PropTypes.func]),\n    level: PropTypes.oneOfType([PropTypes.string, PropTypes.func]),\n    callback: PropTypes.func,\n    children: PropTypes.node,\n  }\n\n  static defaultProps = {\n    level: LEVEL_ERROR,\n  }\n\n  constructor(props) {\n    super(props);\n    invariant(utils.isValidLevel(props.level), `${props.level} is not a valid level setting for Rollbar`);\n    this.state = { ...INITIAL_ERROR_STATE };\n  }\n\n  static getDerivedStateFromError(error) {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error, info) {\n    const { errorMessage, extra, level: targetLevel, callback } = this.props;\n    const custom = utils.value(extra, {}, error, info);\n    const data = { ...info, ...custom };\n    const level = utils.value(targetLevel, LEVEL_ERROR, error, info);\n    const rollbar = getRollbarFromContext(this.context);\n    if (!errorMessage) {\n      rollbar[level](error, data, callback);\n    } else {\n      let logMessage = utils.value(errorMessage, '', error, info);\n      rollbar[level](logMessage, error, data, callback);\n    }\n  }\n\n  resetError = () => {\n    this.setState(INITIAL_ERROR_STATE);\n  }\n\n  render() {\n    const { hasError, error } = this.state;\n    const { fallbackUI: FallbackUI, children } = this.props;\n\n    if (!hasError) {\n      return children;\n    }\n\n    if (!FallbackUI) {\n      return null;\n    }\n\n    return <FallbackUI error={error} resetError={this.resetError} />;\n  }\n}\n"],"names":["INITIAL_ERROR_STATE","hasError","error","ErrorBoundary","props","setState","invariant","utils","level","state","info","errorMessage","extra","targetLevel","callback","custom","data","LEVEL_ERROR","rollbar","getRollbarFromContext","context","logMessage","FallbackUI","fallbackUI","children","resetError","Component","Context","PropTypes","elementType","oneOfType","string","func","object","node"],"mappings":"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"}