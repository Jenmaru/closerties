{"version":3,"file":"provider-2573078d.js","sources":["../src/utils.js","../src/provider.js"],"sourcesContent":["import * as constants from './constants';\n\nconst VALID_LEVELS = constants.default;\n\nexport function value(val, defaultTo, ...args) {\n  if (typeof val === 'function') {\n    return val(...args);\n  }\n  return val;\n}\n\nexport function wrapValue(val, defaultAs) {\n  return (defaultTo, ...args) => value(val, defaultAs === undefined ? defaultTo : defaultAs, ...args);\n}\n\nexport function isValidLevel(level) {\n  return VALID_LEVELS[level] >= VALID_LEVELS[constants.LEVEL_DEBUG]\n    && VALID_LEVELS[level] <= VALID_LEVELS[constants.LEVEL_CRITICAL];\n}\n\nexport function isRollbarInstance(instance) {\n  return !!instance?.options?.accessToken;\n}\n","import React, { Component, createContext } from 'react';\nimport PropTypes from 'prop-types';\nimport Rollbar from 'rollbar';\nimport invariant from 'tiny-invariant';\nimport { isRollbarInstance } from './utils';\n\nexport const Context = createContext();\nContext.displayName = 'Rollbar';\n\nexport const RollbarInstance = Symbol('RollbarInstance');\nexport const BaseOptions = Symbol('BaseOptions');\nexport const RollbarCtor = Symbol('RollbarCtor');\n\nexport function getRollbarFromContext(context) {\n  const { [RollbarInstance]: rollbar } = context;\n  return rollbar;\n}\n\nexport function getRollbarConstructorFromContext(context) {\n  const { [RollbarCtor]: ctor } = context;\n  return ctor;\n}\n\nexport class Provider extends Component {\n  static propTypes = {\n    Rollbar: PropTypes.func,\n    config: (props, propName, componentName) => {\n      if (!props.config && !props.instance) {\n        return new Error(`One of the required props 'config' or 'instance' must be set for ${componentName}.`)\n      }\n      if (props.config) {\n        const configType = typeof props.config;\n        if (configType === 'function' || configType === 'object' && !Array.isArray(configType)) {\n          return;\n        }\n        return new Error(`${propName} must be either an Object or a Function`);\n      }\n    },\n    instance: (props, propName, componentName) => {\n      if (!props.config && !props.instance) {\n        return new Error(`One of the required props 'config' or 'instance' must be set for ${componentName}.`)\n      }\n      if (props.instance && !isRollbarInstance(props.instance)) {\n        return new Error(`${propName} must be a configured instance of Rollbar`);\n      }\n    },\n    children: PropTypes.node\n  }\n\n  constructor(props) {\n    super(props);\n    const { config, Rollbar: ctor = Rollbar, instance } = this.props;\n    invariant(\n      !instance || isRollbarInstance(instance),\n      '`instance` must be a configured instance of Rollbar'\n    );\n    const options = typeof config === 'function' ? config() : config;\n    const rollbar = instance || new ctor(options);\n    // TODO: use isUncaught to filter if this is 2nd Provider added\n    // unless customer wants that\n    this.state = { rollbar, options };\n  }\n\n\n\n  // componentDidUpdate()\n\n  render() {\n    const { children, Rollbar: ctor = Rollbar } = this.props;\n    const { rollbar, options } = this.state;\n\n    return (\n      <Context.Provider value={{ [RollbarInstance]: rollbar, [BaseOptions]: options, [RollbarCtor]: ctor }}>\n        {children}\n      </Context.Provider>\n    )\n  }\n}\n"],"names":["VALID_LEVELS","constants","value","val","defaultTo","args","isValidLevel","level","isRollbarInstance","instance","options","accessToken","Context","createContext","displayName","RollbarInstance","Symbol","BaseOptions","RollbarCtor","getRollbarFromContext","context","rollbar","getRollbarConstructorFromContext","ctor","Provider","props","config","Rollbar","invariant","state","children","React","Component","PropTypes","func","propName","componentName","Error","configType","Array","isArray","node"],"mappings":"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"}